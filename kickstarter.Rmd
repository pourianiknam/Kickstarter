---
title: "Kickstarter"
author: "Pouria Niknam"
date: "5/9/2020"str
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE,echo=FALSE,warning=FALSE}
library(dplyr)
library(readr)
library(lubridate)
library(stringr)
```

```{r, eval=FALSE}
kickstart <- list.files(path="C:\\Users\\Pouria\\OneDrive - UWGB\\Documents\\Kickstarter", full.names = TRUE) %>% 
  lapply(read_csv) %>% 
  bind_rows
```
```{r, eval=FALSE}
write_csv(kickstart,pa th="C:\\Users\\Pouria\\OneDrive - UWGB\\Documents\\Kickstarter.csv")
```
```{r, message=FALSE,echo=FALSE,warning=FALSE,eval=FALSE}
kickstart <- read_csv("C:\\Users\\Pouria\\OneDrive - UWGB\\Documents\\Kickstarter.csv")
```

```{r, message=FALSE,echo=FALSE,warning=FALSE,eval=FALSE}
set.seed(2, sample.kind = "Rounding")
n = dim(kickstart[1])
sample.list <- sample.int(n, size = 5000, replace = FALSE)
ks.sample <- kickstart[sample.list,]
```
```{r, eval=FALSE}
write_csv(ks.sample,path="C:\\Users\\Pouria\\OneDrive - UWGB\\Documents\\ks.sample.csv")
```

```{r, message=FALSE,echo=FALSE,warning=FALSE}
ks.sample <- read_csv("C:\\Users\\Pouria\\OneDrive - UWGB\\Documents\\ks.sample.csv")
```

```{r}
ks.sample$deadline <- as_datetime(ks.sample$deadline)
ks.sample$launched_at <- as_datetime(ks.sample$launched_at)
ks.sample$state_changed_at <- as_datetime(ks.sample$state_changed_at)

ks.sample$live_period <- as.integer(difftime(ks.sample$deadline, ks.sample$launched_at, units = "days"))
ks.sample$state_change_period <- as.integer(difftime(ks.sample$state_changed_at, ks.sample$launched_at, units = "days"))

ks.sample$country <- as.factor(ks.sample$country)
ks.sample$currency <- as.factor(ks.sample$currency)
ks.sample <- subset(ks.sample, ks.sample$state != "live")
ks.sample$state <- as.factor(ks.sample$state)


ks.sample$usd_goal <- ks.sample$goal*ks.sample$static_usd_rate
```

```{r}
ks.sample <- ks.sample[,-c(2,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,34,35,36,38)]
```

```{r}
summary(ks.sample)
write_csv(ks.sample, "ks.sample.clean.csv")
```

```{r}

```


```{r}

test.df <- str_replace_all(ks.sample$category[2],'[:punct:]', " ")
test.df <- str_squish(test.df)
test.df <- str_split(test.df, " ")
test.df <-unlist(test.df, use.names=FALSE)
category <- test.df[6:7]
#test <- lapply(ks.sample$category, str_extract, "[[:slug\":\":]]")
#test <- lapply(test, str_squish)
#test.df <- data.frame(test)
```